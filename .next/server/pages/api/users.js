"use strict";(()=>{var e={};e.id=829,e.ids=[829],e.modules={8432:e=>{e.exports=require("bcryptjs")},1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5352:e=>{e.exports=require("ws")},6249:(e,s)=>{Object.defineProperty(s,"l",{enumerable:!0,get:function(){return function e(s,t){return t in s?s[t]:"then"in s&&"function"==typeof s.then?s.then(s=>e(s,t)):"function"==typeof s&&"default"===t?s:void 0}}})},5145:(e,s,t)=>{t.r(s),t.d(s,{config:()=>m,default:()=>f,routeModule:()=>p});var n={};t.r(n),t.d(n,{default:()=>d});var a=t(1802),r=t(7153),o=t(6249),i=t(9188),l=t(9098),u=t(8432),c=t.n(u);async function d(e,s){let{method:t}=e;switch(await (0,i.Z)(),t){case"GET":try{let e=await l.Z.find({});s.status(200).json({success:!0,data:e})}catch(e){s.status(400).json({success:!1,message:e.message})}break;case"POST":try{let{username:t,email:n,password:a}=e.body;if(!t||!n||!a)return s.status(400).json({success:!1,message:"Please provide all the required fields"});if(await l.Z.findOne({email:n}))return s.status(400).json({success:!1,message:"Email is already in use"});let r=await c().hash(a,10),o=new l.Z({...e.body,password:r});await o.save(),s.status(201).json({success:!0,data:o})}catch(e){s.status(400).json({success:!1,message:e.message})}break;default:s.status(405).json({success:!1,message:"Method not allowed"})}}let f=(0,o.l)(n,"default"),m=(0,o.l)(n,"config"),p=new a.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/users",pathname:"/api/users",bundlePath:"",filename:""},userland:n})},9188:(e,s,t)=>{t.d(s,{Z:()=>c});var n=t(1185),a=t.n(n);let r=process.env.MONGO_URI;if(!r)throw Error("Please define the MONGO_URI variable for the MongoDB connection.");let o=global.mongo;async function i(){return o.conn||(o.promise||(o.promise=a().connect(r,{bufferCommands:!1}).then(e=>(console.log("MongoDB connected"),e))),o.conn=await o.promise),o.conn}o||(o=global.mongo={conn:null,promise:null});let l=new(t(5352)).Server({port:8080}),u={};l.on("connection",e=>{e.on("message",s=>{let t=JSON.parse(s);switch(t.type){case"join":let{roomId:n}=t;u[n]||(u[n]=[]),u[n].push(e);break;case"offer":case"answer":case"candidate":let a=u[t.roomId];a&&a.forEach(s=>{s!==e&&s.send(JSON.stringify(t))})}}),e.on("close",()=>{for(let s in u)u[s]=u[s].filter(s=>s!==e)})}),console.log("Signaling server is running on ws://localhost:8080");let c=i},9098:(e,s,t)=>{t.d(s,{Z:()=>o});var n=t(1185),a=t.n(n);let r=new(a()).Schema({username:{type:String,required:!0,trim:!0},email:{type:String,required:!0,unique:!0,lowercase:!0,trim:!0,match:[/.+\@.+\..+/,"Please fill a valid email address"]},password:{type:String,required:!0,minlength:6},isAdmin:{type:Boolean,default:!1},createdAt:{type:Date,default:Date.now}}),o=a().models.User||a().model("User",r)},7153:(e,s)=>{var t;Object.defineProperty(s,"x",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(t||(t={}))},1802:(e,s,t)=>{e.exports=t(145)}};var s=require("../../webpack-api-runtime.js");s.C(e);var t=s(s.s=5145);module.exports=t})();