"use strict";(()=>{var e={};e.id=104,e.ids=[104],e.modules={1185:e=>{e.exports=require("mongoose")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},5352:e=>{e.exports=require("ws")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,n){return n in t?t[n]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,n)):"function"==typeof t&&"default"===n?t:void 0}}})},211:(e,t,n)=>{n.r(t),n.d(t,{config:()=>u,default:()=>c,routeModule:()=>g});var o={};n.r(o),n.d(o,{default:()=>d});var r=n(1802),i=n(7153),s=n(6249),a=n(9188),l=n(8946);async function d(e,t){if(await (0,a.Z)(),"GET"===e.method)try{let e=await l.Z.find({}).select("name phoneNumber date time message meetingID doctor");t.status(200).json(e)}catch(e){t.status(500).json({message:"Error fetching bookings",error:e})}else if("POST"===e.method)try{let n=e.body,o=Math.random().toString(36).substr(2,9),r=new l.Z({...n,meetingID:o});await r.save(),t.status(201).json({message:"Booking confirmed!",booking:r})}catch(e){t.status(500).json({message:"Error saving booking",error:e})}else if("DELETE"===e.method)try{let{id:n}=e.query;await l.Z.findByIdAndDelete(n),t.status(200).json({message:"Booking cancelled successfully"})}catch(e){t.status(500).json({message:"Error cancelling booking",error:e})}else t.setHeader("Allow",["GET","POST","DELETE"]),t.status(405).end(`Method ${e.method} Not Allowed`)}let c=(0,s.l)(o,"default"),u=(0,s.l)(o,"config"),g=new r.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/book",pathname:"/api/book",bundlePath:"",filename:""},userland:o})},9188:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(1185),r=n.n(o);let i=process.env.MONGO_URI;if(!i)throw Error("Please define the MONGO_URI variable for the MongoDB connection.");let s=global.mongo;async function a(){return s.conn||(s.promise||(s.promise=r().connect(i,{bufferCommands:!1}).then(e=>(console.log("MongoDB connected"),e))),s.conn=await s.promise),s.conn}s||(s=global.mongo={conn:null,promise:null});let l=new(n(5352)).Server({port:8080}),d={};l.on("connection",e=>{e.on("message",t=>{let n=JSON.parse(t);switch(n.type){case"join":let{roomId:o}=n;d[o]||(d[o]=[]),d[o].push(e);break;case"offer":case"answer":case"candidate":let r=d[n.roomId];r&&r.forEach(t=>{t!==e&&t.send(JSON.stringify(n))})}}),e.on("close",()=>{for(let t in d)d[t]=d[t].filter(t=>t!==e)})}),console.log("Signaling server is running on ws://localhost:8080");let c=a},8946:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(1185),r=n.n(o);let i=new(r()).Schema({name:{type:String,required:!0},phoneNumber:{type:String,required:!0},date:{type:Date,required:!0},time:{type:String,required:!0},message:{type:String},meetingID:{type:String,required:!0},doctor:{name:{type:String,required:!0},specialization:{type:String,required:!0},experience:{type:Number,required:!0},availability:{type:String,required:!0}}}),s=r().models.Booking||r().model("Booking",i)},7153:(e,t)=>{var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},1802:(e,t,n)=>{e.exports=n(145)}};var t=require("../../webpack-api-runtime.js");t.C(e);var n=t(t.s=211);module.exports=n})();